<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="SALVATORE LAMENDOLA (vt0r)"><meta name=description content="Though I&rsquo;ve already created the same thing in another postusing a Bash function, I had a very important need for a Perl script that produced random strings. Once I got that little script working, I decided to rewrite the original Bash password generator function entirely in Perl. This may not be the most efficient way to hack it up, but I&rsquo;m no Perl monger, so don&rsquo;t expect perfection. This script does work well, however, and requires no additional modules, so it can be run anywhere there is a Perl interpreter."><meta property="og:title" content="Generating Random Passwords in Perl"><meta property="og:description" content="Though I&rsquo;ve already created the same thing in another postusing a Bash function, I had a very important need for a Perl script that produced random strings. Once I got that little script working, I decided to rewrite the original Bash password generator function entirely in Perl. This may not be the most efficient way to hack it up, but I&rsquo;m no Perl monger, so don&rsquo;t expect perfection. This script does work well, however, and requires no additional modules, so it can be run anywhere there is a Perl interpreter."><meta property="og:type" content="article"><meta property="og:url" content="https://lamendola.me/2013/04/28/generating-random-passwords-in-perl/"><meta property="article:published_time" content="2013-04-28T21:19:40+00:00"><meta property="article:modified_time" content="2013-04-28T21:19:40+00:00"><title>Generating Random Passwords in Perl</title><link rel=canonical href=https://lamendola.me/2013/04/28/generating-random-passwords-in-perl/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/solarized-dark.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Source+Sans+Pro:400"><link rel=stylesheet href=/css/reset.css><link rel=stylesheet href=/css/pygments.css><link rel=stylesheet href=/css/main.css><link rel="shortcut icon" href=/images/favicon.ico></head><body lang=en><section class=header><div class=container><div class=content><a href=/><img class=avatar src=/images/avatar@2x.png srcset="https://lamendola.me/images/avatar@2x.png 1x"></a>
<a href=/><div class=name>SALVATORE LAMENDOLA (vt0r)</div></a><nav><ul><li class=nav-><a href=https://lamendola.me/about/><span>About</span></a></li><li class=nav-blog><a href=https://lamendola.me/blog/><span>Blog</span></a></li><li class=nav-><a href=https://ip.lamendola.me/><span>What's my IP?</span></a></li><li class=nav-><a href=https://1a4.fr/><span>Encrypted Pastebin</span></a></li></ul></nav></div></div></section><section class=icons><div class=container><div class=content><a href=https://github.com/vt0r target=_blank rel=noopener><img class=icon src=/img/github.svg alt=github></a>
<a href=https://keybase.io/vt0r target=_blank rel=noopener><img class=icon src=/img/keybase.svg alt=keybase></a>
<a href=https://www.linkedin.com/in/salvatorelamendola target=_blank rel=noopener><img class=icon src=/img/linkedin.svg alt=linkedin></a>
<a href=mailto:salvatore[at@@]lamendola[dot..]me><img class=icon src=/img/email.svg alt=email></a></div></div></section><section class="main post non-narrow zero-top-spacing"><div class=container><div class=content><div class=front-matter><div class=title-container><div class=page-heading>Generating Random Passwords in Perl</div><div class=initials><a href=https://lamendola.me></a></div></div><div class=meta><div class=date title="Sun Apr 28 2013 21:19:40 UTC">Apr 28, 2013</div><div class=reading-time><div class=middot></div>3 minutes read</div></div></div><div class=markdown><p>Though I&rsquo;ve already created the same thing in another post using a Bash function, I had a very important need for a Perl script that produced random strings. Once I got that little script working, I decided to rewrite the original Bash password generator function entirely in Perl. This may not be the most efficient way to hack it up, but I&rsquo;m no Perl monger, so don&rsquo;t expect perfection. This script does work well, however, and requires no additional modules, so it can be run anywhere there is a Perl interpreter.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=color:#75715e>#!/usr/bin/perl -w</span>

<span style=color:#66d9ef>use</span> warnings;
<span style=color:#66d9ef>use</span> strict;

<span style=color:#75715e># Default length/number</span>
<span style=color:#66d9ef>my</span> $len <span style=color:#f92672>=</span> <span style=color:#ae81ff>19</span>;
<span style=color:#66d9ef>my</span> $num <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;

<span style=color:#75715e># Custom definition for safe symbols</span>
<span style=color:#66d9ef>my</span> @symbols <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;-&#39;</span>, <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;!&#39;</span>, <span style=color:#e6db74>&#39;@&#39;</span>, <span style=color:#e6db74>&#39;#&#39;</span>, <span style=color:#e6db74>&#39;$&#39;</span>, <span style=color:#e6db74>&#39;%&#39;</span>, <span style=color:#e6db74>&#39;^&#39;</span>, <span style=color:#e6db74>&#39;&amp;&#39;</span>, <span style=color:#e6db74>&#39;*&#39;</span>, <span style=color:#e6db74>&#39;/&#39;</span>, <span style=color:#e6db74>&#39;\\&#39;</span>, <span style=color:#e6db74>&#39;(&#39;</span>, <span style=color:#e6db74>&#39;)&#39;</span>, <span style=color:#e6db74>&#39;_&#39;</span>, <span style=color:#e6db74>&#39;+&#39;</span>, <span style=color:#e6db74>&#39;{&#39;</span>, <span style=color:#e6db74>&#39;}&#39;</span>, <span style=color:#e6db74>&#39;|&#39;</span>, <span style=color:#e6db74>&#39;:&#39;</span>, <span style=color:#e6db74>&#39;&lt;&#39;</span>, <span style=color:#e6db74>&#39;&gt;&#39;</span>, <span style=color:#e6db74>&#39;?&#39;</span>, <span style=color:#e6db74>&#39;=&#39;</span>, <span style=color:#e6db74>&#39;A&#39;</span><span style=color:#f92672>..</span><span style=color:#e6db74>&#39;Z&#39;</span>, <span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>..</span><span style=color:#e6db74>&#39;z&#39;</span>, <span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>..</span><span style=color:#e6db74>&#39;9&#39;</span>);

<span style=color:#75715e># Alphanumeric-only option</span>
<span style=color:#66d9ef>my</span> @alphanumeric <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;A&#39;</span><span style=color:#f92672>..</span><span style=color:#e6db74>&#39;Z&#39;</span>, <span style=color:#e6db74>&#39;a&#39;</span><span style=color:#f92672>..</span><span style=color:#e6db74>&#39;z&#39;</span>, <span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>..</span><span style=color:#e6db74>&#39;9&#39;</span>);

<span style=color:#75715e># Pull in args and list usage</span>
<span style=color:#66d9ef>my</span> $numargs <span style=color:#f92672>=</span> scalar @ARGV; 
    <span style=color:#66d9ef>if</span> ($numargs <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> $ARGV[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#34;-h&#34;</span>) {
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;Sal&#39;s Random Password Generator\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;-------------------------------\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;Usage: pwgen &lt;OPTIONS&gt; [length] [number] (length and number optional)\n\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;OPTIONS (MUST SPECIFY ONE!):\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;-s               Add symbols to output (NOT FOR MYSQL!)\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;-a               Alphanumeric only\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;-p               Generate phpMyAdmin Blowfish secret (for cookie auth)\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;-w               Generate Wordpress encryption keys (wp-config.php)\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;-h               Display this usage information\n\n&#34;</span>;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;If no length or number are defined, a default length of $len and number of $num will be used.\n&#34;</span>;
        exit(<span style=color:#ae81ff>0</span>);
    } 

<span style=color:#66d9ef>my</span> $pwtype <span style=color:#f92672>=</span> $ARGV[<span style=color:#ae81ff>0</span>];

<span style=color:#66d9ef>if</span> (defined $ARGV[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&amp;&amp;</span> $ARGV[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^\d+$/</span>) {
    $len <span style=color:#f92672>=</span> $ARGV[<span style=color:#ae81ff>1</span>];
}

<span style=color:#66d9ef>if</span> (defined $ARGV[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>&amp;&amp;</span> $ARGV[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=~</span><span style=color:#e6db74> /^\d+$/</span>) {
    $num <span style=color:#f92672>=</span> $ARGV[<span style=color:#ae81ff>2</span>];
}

<span style=color:#66d9ef>if</span> ($pwtype <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#34;-s&#34;</span>) {
    <span style=color:#66d9ef>my</span> $count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
    <span style=color:#66d9ef>my</span> $pass;
    <span style=color:#66d9ef>while</span> ($count <span style=color:#f92672>&lt;</span> $num) {
        $pass <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
        $pass <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span>$len;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$pass\n&#34;</span>;
        $count<span style=color:#f92672>++</span>;
    }
}

<span style=color:#66d9ef>if</span> ($pwtype <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#34;-a&#34;</span>) {
    <span style=color:#66d9ef>my</span> $count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
    <span style=color:#66d9ef>my</span> $pass;
    <span style=color:#66d9ef>while</span> ($count <span style=color:#f92672>&lt;</span> $num) {
        $pass <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
        $pass <span style=color:#f92672>.=</span> $alphanumeric[rand @alphanumeric] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span>$len;
        <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$pass\n&#34;</span>;
        $count<span style=color:#f92672>++</span>;
    }
}

<span style=color:#66d9ef>if</span> ($pwtype <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#34;-p&#34;</span>) {
    <span style=color:#66d9ef>my</span> $pass <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    $pass <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$pass\n&#34;</span>;
}

<span style=color:#66d9ef>if</span> ($pwtype <span style=color:#f92672>eq</span> <span style=color:#e6db74>&#34;-w&#34;</span>) {
    <span style=color:#66d9ef>my</span> $pass1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass3 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass4 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass5 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass6 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass7 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    <span style=color:#66d9ef>my</span> $pass8 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
    $pass1 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;AUTH_KEY&#39;,\t\t&#39;$pass1&#39;);\n&#34;</span>;
    $pass2 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;SECURE_AUTH_KEY&#39;,\t&#39;$pass2&#39;);\n&#34;</span>;
    $pass3 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;LOGGED_IN_KEY&#39;,\t\t&#39;$pass3&#39;);\n&#34;</span>;
    $pass4 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;NONCE_KEY&#39;,\t\t&#39;$pass4&#39;);\n&#34;</span>;
    $pass5 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;AUTH_SALT&#39;,\t\t&#39;$pass5&#39;);\n&#34;</span>;
    $pass6 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;SECURE_AUTH_SALT&#39;,\t&#39;$pass6&#39;);\n&#34;</span>;
    $pass7 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;LOGGED_IN_SALT&#39;,\t&#39;$pass7&#39;);\n&#34;</span>;
    $pass8 <span style=color:#f92672>.=</span> $symbols[rand @symbols] <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>..</span><span style=color:#ae81ff>64</span>;
    <span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;define(&#39;NONCE_SALT&#39;,\t\t&#39;$pass8&#39;);\n&#34;</span>;
}
</code></pre></div><p>Save this as <code>salpwgen.pl</code> or whatever file name you choose. The first line allows you to make the file executable and run it as <code>./salpwgen.pl</code>, assuming your Perl interpreter is in <code>/usr/bin/perl</code>.</p><p>If you have any suggestions, or if you would like to see some other type of secret/hash generated, please feel free to comment below.</p><br><p class=back-to-posts><a href=/blog>Back to posts</a></p></div><br><div class=disqus></div></div></div></section><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js></script><script type=text/javascript>hljs.initHighlightingOnLoad();</script></body></html>