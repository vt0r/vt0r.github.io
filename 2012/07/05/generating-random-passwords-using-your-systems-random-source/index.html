<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="SALVATORE LAMENDOLA (vt0r)"><meta name=description content="Today, we will re-invent the wheel with a simple bash function to generate some passwords and a few hashes as well. Why would I bother coding something when several good programs already exist to perform the same functionality? Well, that&rsquo;s simple: I use this most on systems where I cannot install software. Any user that has SSH access can edit their own .bashrc , so I decided since random password generation is a daily task I perform at my job and elsewhere, it made sense to have a good way to generate passwords."><meta property="og:title" content="Generating Random Passwords in Bash Using Your System's Random Source"><meta property="og:description" content="Today, we will re-invent the wheel with a simple bash function to generate some passwords and a few hashes as well. Why would I bother coding something when several good programs already exist to perform the same functionality? Well, that&rsquo;s simple: I use this most on systems where I cannot install software. Any user that has SSH access can edit their own .bashrc , so I decided since random password generation is a daily task I perform at my job and elsewhere, it made sense to have a good way to generate passwords."><meta property="og:type" content="article"><meta property="og:url" content="https://lamendola.me/2012/07/05/generating-random-passwords-using-your-systems-random-source/"><meta property="article:published_time" content="2012-07-05T09:30:21+00:00"><meta property="article:modified_time" content="2012-07-05T09:30:21+00:00"><title>Generating Random Passwords in Bash Using Your System's Random Source</title><link rel=canonical href=https://lamendola.me/2012/07/05/generating-random-passwords-using-your-systems-random-source/><link rel=preload href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Source+Sans+Pro:400&display=swap" as=style onload="this.onload=null;this.rel='stylesheet'"><link rel=stylesheet href=/css/reset.css><link rel=preload href=/css/pygments.css as=style onload="this.onload=null;this.rel='stylesheet'"><link rel=stylesheet href=/css/main.css><link rel="shortcut icon" href=/images/favicon.ico></head><body lang=en><section class=header><div class=container><div class=content><a href=/><img class=avatar src=/images/avatar@2x.png srcset="https://lamendola.me/images/avatar@2x.png 1x"></a>
<a href=/><div class=name>SALVATORE LAMENDOLA (vt0r)</div></a><nav><ul><li class=nav-><a href=https://lamendola.me/about/><span>About</span></a></li><li class=nav-blog><a href=https://lamendola.me/blog/><span>Blog</span></a></li><li class=nav-><a href=https://ip.1a4.fr/><span>What's my IP?</span></a></li><li class=nav-><a href=https://1a4.fr/><span>Encrypted Pastebin</span></a></li></ul></nav></div></div></section><section class=icons><div class=container><div class=content><a href=https://github.com/vt0r target=_blank rel=noopener><img class=icon src=/img/github.svg alt=github></a>
<a href=https://keybase.io/vt0r target=_blank rel=noopener><img class=icon src=/img/keybase.svg alt=keybase></a>
<a href=https://www.linkedin.com/in/salvatorelamendola target=_blank rel=noopener><img class=icon src=/img/linkedin.svg alt=linkedin></a>
<a href=mailto:salvatore[at@@]lamendola[dot..]me><img class=icon src=/img/email.svg alt=email></a></div></div></section><section class="main post non-narrow zero-top-spacing"><div class=container><div class=content><div class=front-matter><div class=title-container><div class=page-heading>Generating Random Passwords in Bash Using Your System's Random Source</div><div class=initials><a href=https://lamendola.me></a></div></div><div class=meta><div class=date title="Thu Jul 5 2012 09:30:21 UTC">Jul 5, 2012</div><div class=reading-time><div class=middot></div>4 minutes read</div></div></div><div class=markdown><p>Today, we will re-invent the wheel with a simple bash function to generate some passwords and a few hashes as well. Why would I bother coding something when several good programs already exist to perform the same functionality? Well, that&rsquo;s simple: I use this most on systems where I cannot install software. Any user that has SSH access can edit their own .bashrc , so I decided since random password generation is a daily task I perform at my job and elsewhere, it made sense to have a good way to generate passwords. There are a few hashes you can use this for as well. This function will generate the hash used for cookie authentication in phpMyAdmin and it will also generate the hashes used to secure authentication via Wordpress (to be used in wp-config.php). Paste this function in its entirety into your .bashrc or /etc/profile , /etc/bashrc , /etc/bash.bashrc (wherever you feel it should go):</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=color:#719e07>function</span> pwgen<span style=color:#719e07>()</span> <span style=color:#719e07>{</span>
    <span style=color:#719e07>case</span> <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$1</span><span style=color:#2aa198>&#34;</span> in
    -s|--symbols<span style=color:#719e07>)</span>
        <span style=color:#b58900>export</span> <span style=color:#268bd2>SYMBOLS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#268bd2>PHPMA</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>WORDPRESS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>YUBIKEY</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span>
    ;;
    -a|--alphanumeric<span style=color:#719e07>)</span>
        <span style=color:#b58900>export</span> <span style=color:#268bd2>SYMBOLS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>PHPMA</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>WORDPRESS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>YUBIKEY</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span>
    ;;
    -p|--phpmyadmin<span style=color:#719e07>)</span>
        <span style=color:#b58900>export</span> <span style=color:#268bd2>PHPMA</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#268bd2>WORDPRESS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>YUBIKEY</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span>
    ;;
    -w|--wordpress<span style=color:#719e07>)</span>
        <span style=color:#b58900>export</span> <span style=color:#268bd2>WORDPRESS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#268bd2>PHPMA</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>YUBIKEY</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span>
    ;;
    -y|--yubikey<span style=color:#719e07>)</span>
        <span style=color:#b58900>export</span> <span style=color:#268bd2>YUBIKEY</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#268bd2>PHPMA</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span> <span style=color:#268bd2>WORDPRESS</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;0&#34;</span>
    ;;
    -h|--help|*<span style=color:#719e07>)</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;Usage: pwgen &lt;OPTIONS&gt; [length] [number] (length and number optional)&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;OPTIONS (MUST SPECIFY ONE!):&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;--symbols (-s)               Add symbols to output (NOT FOR MYSQL!)&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;--alphanumeric (-a)          Alphanumeric only&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;--phpmyadmin (-p)            Generate phpMyAdmin Blowfish secret (for cookie auth)&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;--wordpress (-w)             Generate Wordpress encryption keys (wp-config.php)&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;--yubikey (-y)               Generate Public/Private/Secret keys for Yubikey OTP&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;--help (-h)                  Display this usage information&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;&#34;</span>
        <span style=color:#b58900>echo</span> <span style=color:#2aa198>$&#34;If no length or number are defined, a default length of 19 and number of 1 will be used.&#34;</span>
        <span style=color:#719e07>return</span> <span style=color:#2aa198>1</span>
    ;;
    <span style=color:#719e07>esac</span>

<span style=color:#719e07>if</span> <span style=color:#719e07>[</span> -z <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$2</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>]</span>
<span style=color:#719e07>then</span>
     <span style=color:#b58900>export</span> <span style=color:#268bd2>LEN</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;19&#34;</span>
<span style=color:#719e07>else</span>
     <span style=color:#b58900>export</span> <span style=color:#268bd2>LEN</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$2</span><span style=color:#2aa198>&#34;</span>
<span style=color:#719e07>fi</span>

<span style=color:#719e07>if</span> <span style=color:#719e07>[</span> -z <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$3</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>]</span>
<span style=color:#719e07>then</span>
     <span style=color:#b58900>export</span> <span style=color:#268bd2>NUM</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;1&#34;</span>
<span style=color:#719e07>else</span>
     <span style=color:#b58900>export</span> <span style=color:#268bd2>NUM</span><span style=color:#719e07>=</span><span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$3</span><span style=color:#2aa198>&#34;</span>
<span style=color:#719e07>fi</span>

<span style=color:#719e07>if</span> <span style=color:#719e07>[</span> <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$PHPMA</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#719e07>]</span>
<span style=color:#719e07>then</span>
     tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>46</span> | head -n <span style=color:#2aa198>1</span>
     <span style=color:#719e07>return</span> <span style=color:#2aa198>0</span>
<span style=color:#719e07>elif</span> <span style=color:#719e07>[</span> <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$WORDPRESS</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#719e07>]</span>
<span style=color:#719e07>then</span>
     <span style=color:#268bd2>WP1</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP2</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP3</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP4</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP5</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP6</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP7</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#268bd2>WP8</span><span style=color:#719e07>=</span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>64</span> | head -n 1<span style=color:#719e07>)</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;AUTH_KEY&#39;,         &#39;</span><span style=color:#268bd2>$WP1</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;SECURE_AUTH_KEY&#39;,  &#39;</span><span style=color:#268bd2>$WP2</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;LOGGED_IN_KEY&#39;,    &#39;</span><span style=color:#268bd2>$WP3</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;NONCE_KEY&#39;,        &#39;</span><span style=color:#268bd2>$WP4</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;AUTH_SALT&#39;,        &#39;</span><span style=color:#268bd2>$WP5</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;SECURE_AUTH_SALT&#39;, &#39;</span><span style=color:#268bd2>$WP6</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;LOGGED_IN_SALT&#39;,   &#39;</span><span style=color:#268bd2>$WP7</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;define(&#39;NONCE_SALT&#39;,       &#39;</span><span style=color:#268bd2>$WP8</span><span style=color:#2aa198>&#39;);&#34;</span>
     <span style=color:#719e07>return</span> <span style=color:#2aa198>0</span>
<span style=color:#719e07>elif</span> <span style=color:#719e07>[</span> <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$YUBIKEY</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#719e07>]</span>
<span style=color:#719e07>then</span>
     <span style=color:#586e75>#echo &#34;Public Identity: vv$(tr -dc &#39;a-f0-9&#39; &lt; /dev/random | fold -w 10 | head -n 1 | tr &#34;[0123456789abcdef]&#34; &#34;[cbdefghijklnrtuv]&#34;)&#34;</span>
     <span style=color:#586e75>#echo &#34;Private Identity: $(tr -dc &#39;a-f0-9&#39; &lt; /dev/random | fold -w 12 | head -n 1)&#34;</span>
     <span style=color:#586e75>#echo &#34;Secret Key: $(tr -dc &#39;a-f0-9&#39; &lt; /dev/random | fold -w 32 | head -n 1)&#34;</span>
     <span style=color:#b58900>echo</span> <span style=color:#2aa198>&#34;OTP AES Key: </span><span style=color:#719e07>$(</span>tr -dc <span style=color:#2aa198>&#39;a-f0-9&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>40</span> | head -n 1<span style=color:#719e07>)</span><span style=color:#2aa198>&#34;</span>
<span style=color:#719e07>elif</span> <span style=color:#719e07>[</span> <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$SYMBOLS</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;1&#34;</span> <span style=color:#719e07>]</span>
<span style=color:#719e07>then</span>
     tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9-_!@#$%^&amp;*/\()_+{}|:&lt;&gt;?=&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$LEN</span><span style=color:#2aa198>&#34;</span> | head -n <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$NUM</span><span style=color:#2aa198>&#34;</span>
<span style=color:#719e07>else</span>
     tr -dc <span style=color:#2aa198>&#39;a-zA-Z0-9&#39;</span> &lt; /dev/random | fold -w <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$LEN</span><span style=color:#2aa198>&#34;</span> | head -n <span style=color:#2aa198>&#34;</span><span style=color:#268bd2>$NUM</span><span style=color:#2aa198>&#34;</span>
<span style=color:#719e07>fi</span>
<span style=color:#719e07>}</span>
</code></pre></div><p>Now, you can name this whatever you like. There is already a very good program called pwgen which I use quite often, so on my system, this is actually called &lsquo;salpwgen&rsquo; to avoid conflicts. Once you have saved this function into your .bashrc, you just need to run the following command to read from .bashrc:</p><p>You may notice we&rsquo;re using /dev/random as the random source. This may cause blocking and take long amounts of time if you don&rsquo;t have sufficient entropy available. You have two choices in this situation:</p><ol><li>You can install an amazing piece of software known as haveged which will automatically push random data into /dev/random which passes all FIPS tests.</li><li>You can use /dev/urandom, which is a non-blocking source, but can contain repeats of previously used data (that&rsquo;s how it prevents from blocking).</li></ol><p>The choice is yours, but haveged is highly recommended as you never know when you will need randomness!</p><p>If you have any suggestions on ways I can improve my simple password generator, please feel free to leave a comment and I might consider adding a particular password or hash type.</p><br><p class=back-to-posts><a href=/blog>Back to posts</a></p></div><br><div class=disqus></div></div></div></section></body></html>